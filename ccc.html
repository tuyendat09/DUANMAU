if (isset($_POST['btnAddToCart']) && ($_POST['btnAddToCart'])) {
  $img = $_POST['img'];
  $name = $_POST['name'];
  $mainprice = $_POST['mainprice'];
  $quantity = 1;
  // Kiểm tra xem có session cart chưa
  if (isset($_SESSION['cart']) && ($_SESSION['cart'] != "")) {
    $flag = false;
    // Kiểm tra xem sản phẩm đã có trong giỏ hàng chưa
    foreach ($_SESSION['cart'] as $key => $value) {
      // Nếu có rồi thì tăng số lượng lên 1
      if ($value['name'] == $name) {
        $_SESSION['cart'][$key]['quantity'] += 1;
        $flag = true;
      }
    }
    // Nếu chưa có thì thêm vào giỏ hàng
    if (!$flag) {
      $product = [
        "img" => $img,
        "name" => $name,
        "mainprice" => $mainprice,
        "quantity" => $quantity
      ];
      $_SESSION['cart'][] = $product;
    }
  }
  // Nếu chưa có session cart 
  else {
    $product = [
      "img" => $img,
      "name" => $name,
      "mainprice" => $mainprice,
      "quantity" => $quantity
    ];
    $_SESSION['cart'][] = $product;
  }
  header('Location: index.php?page=cart');
}


<!-- CUA TAO -->
if(isset($_POST['addcart'])) {
  $productName = $_POST['name'];
  $productImg = $_POST['img'];
  $productPrice = $_POST['price'];
  $productQuantity = 1;
  if (isset($_SESSION['cart']) && ($_SESSION['cart'] != "")) {
      $flag = false;
      // Kiểm tra xem sản phẩm đã có trong giỏ hàng chưa
      foreach ($_SESSION['cart'] as $key => $value) {
        // Nếu có rồi thì tăng số lượng lên 1
        if ($value['name'] == $name) {
          $_SESSION['cart'][$key]['quantity'] += 1;
          $flag = true;
        }
      }
      // Nếu chưa có thì thêm vào giỏ hàng
      if (!$flag) {
        $product = [
          'name' => $productName,
          'img' => $productImg,
          'price' => $productPrice,
          'quantity' => $productQuantity,
        ];
      array_push($_SESSION['cart'],$product);
      }
    }
    // Nếu chưa có session cart 
    else {
      $product = [
          'name' => $productName,
          'img' => $productImg,
          'price' => $productPrice,
          'quantity' => $productQuantity,
      ];
     array_push($_SESSION['cart'],$product);
    }
  header('location: index.php?pg=viewcart');
}